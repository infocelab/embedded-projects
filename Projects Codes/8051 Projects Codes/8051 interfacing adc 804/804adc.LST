C51 COMPILER V9.52.0.0   804ADC                                                            01/15/2015 19:14:20 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE 804ADC
OBJECT MODULE PLACED IN 804adc.OBJ
COMPILER INVOKED BY: E:\C51\BIN\C51.EXE 804adc.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          
   2          #include <REGX51.H>
   3          #include<stdio.h>
   4          #include<string.h>
   5          
   6          sbit INTR = P0^5;
   7          sbit RD_ADC = P0^4;
   8          sbit WR_ADC = P0^3;
   9          sfr MYDATA = 0x90;        //Port-1
  10          sfr LcdData = 0xA0;        //Port-2
  11          sbit RS =  P0^0;
  12          sbit RW =  P0^2;
  13          sbit EN =  P0^1;
  14          void lcdcmd(unsigned char value);
  15          void lcddata(unsigned char value);
  16          void lcdstr(unsigned char msg[]);
  17          void Delay(unsigned int itime);
  18          void SerTX(unsigned char x);
  19          void SerTX_str(unsigned char msg[]);
  20          unsigned char msg[] = "temp --->";
  21          void main()
  22          {
  23   1          unsigned int temp;
  24   1          int hundreds,tens,ones;
  25   1          unsigned char buffer[10];
  26   1          TMOD = 0x20;    //Timer-1, 8-Bit Auto Reload Mode
  27   1          TH1 = 0xFD;        //9600 Baud Rate When Crystal Used is 11.0592MHZ
  28   1          SCON = 0x50;
  29   1          TR1 = 1;        //Start Timer
  30   1          MYDATA = 0xFF;    //Making P1 as Input Port
  31   1          INTR = 1;
  32   1          RD_ADC = 1;        //Set RD high
  33   1          WR_ADC = 1;   //Set WR high
  34   1        lcdcmd(0x38);
  35   1          Delay(1);
  36   1          lcdcmd(0x0E);
  37   1          Delay(1);
  38   1          lcdcmd(0x01);
  39   1          Delay(1);
  40   1          lcdcmd(0x80);
  41   1          lcdstr("temp");
  42   1          lcdcmd(0x0C);
  43   1          while(1)
  44   1          {      
  45   2              lcdcmd(0xC0);                                                                
  46   2              WR_ADC = 0;        //Send WR Pulse
  47   2              Delay(1);
  48   2              WR_ADC = 1;        //Low-High Pulse means Start of Conversion
  49   2              while(INTR == 1);    //Wait until End of Conversion
  50   2              //When Conversion Gets Completed the INTR Pin Goes Low we get out of the Loop
  51   2              RD_ADC = 0;        //Send RD Pulse
  52   2              temp = MYDATA * 2;
  53   2              //Conversion Process Starts Here        
  54   2                  ones = temp%1;
  55   2                  temp = temp/1;
C51 COMPILER V9.52.0.0   804ADC                                                            01/15/2015 19:14:20 PAGE 2   

  56   2                  tens = temp%1;
  57   2                  hundreds = temp/10;
  58   2                  sprintf(buffer,"%d.%d%d C",hundreds,tens,ones);
  59   2                  lcdstr(buffer);
  60   2                  SerTX_str(msg);
  61   2                  SerTX_str(buffer);
  62   2                  SerTX(13);
  63   2                  SerTX(13);
  64   2                  Delay(10);
  65   2                  Delay(10);
  66   2                  RD_ADC = 1;
  67   2          }
  68   1      }
  69          void lcdcmd(unsigned char value)
  70          {
  71   1          LcdData = value;
  72   1          RS = 0;
  73   1          RW = 0;
  74   1          EN = 1;
  75   1          Delay(1);
  76   1          EN = 0;
  77   1      }
  78          void lcddata(unsigned char value)
  79          {
  80   1          LcdData = value;
  81   1          RS = 1;
  82   1          RW = 0;
  83   1          EN = 1;
  84   1          Delay(1);
  85   1          EN = 0;
  86   1      }
  87          void Delay(unsigned int itime)
  88          {
  89   1          unsigned int i,j;
  90   1          for(i=0;i<1275;i++)
  91   1          for(j=0;j<itime;j++);
  92   1      }
  93          void lcdstr(unsigned char msg[])
  94          {
  95   1          unsigned short int len,i;
  96   1          len = strlen(msg);
  97   1          for(i=0;i<len;i++)
  98   1          {
  99   2              lcddata(msg[i]);
 100   2              Delay(1);
 101   2          }
 102   1      }
 103          void SerTX(unsigned char x)
 104          {
 105   1          SBUF = x;
 106   1          while(TI == 0);
 107   1          TI = 0;
 108   1      }
 109          void SerTX_str(unsigned char msg[])
 110          {
 111   1          unsigned short len,i;
 112   1          len = strlen(msg);
 113   1          for(i=0;i<len;i++)
 114   1          {    
 115   2              SerTX(msg[i]);
 116   2          }
 117   1      }
C51 COMPILER V9.52.0.0   804ADC                                                            01/15/2015 19:14:20 PAGE 3   

 118          
 119          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    414    ----
   CONSTANT SIZE    =     15    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     10      30
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
